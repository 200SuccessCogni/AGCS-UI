import{j as e,r as f,i as p,u as P,a as G,b as n,G as b,T as l,B as d,c as H,P as N}from"./index-8f45885e.js";import{C as F}from"./auto-1f95ca72.js";import{R as q,T as V,C as W}from"./ReviewItem-90fb11b5.js";import{c as U}from"./shared.service-6180cc91.js";import{G as o}from"./Grid-42d30c92.js";function J(r){return e.jsx(F,{type:"pie",data:r.chartData,options:r.options})}var g={},K=p;Object.defineProperty(g,"__esModule",{value:!0});var j=g.default=void 0,Q=K(f()),X=e,Y=(0,Q.default)((0,X.jsx)("path",{d:"M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm0 12-4.34 4.34L12 14H3v-2l3-7h9v10zm4-12h4v12h-4V3z"}),"ThumbDownOffAltOutlined");j=g.default=Y;var v={},Z=p;Object.defineProperty(v,"__esModule",{value:!0});var w=v.default=void 0,ee=Z(f()),te=e,se=(0,ee.default)((0,te.jsx)("path",{d:"M9 21h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.58 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2zM9 9l4.34-4.34L12 10h9v2l-3 7H9V9zM1 9h4v12H1z"}),"ThumbUpOutlined");w=v.default=se;function x(r){return e.jsxs(N,{elevation:0,sx:{display:"flex",justifyContent:"space-between",flexDirection:"column",alignItems:"flex-start",padding:"0.5rem 1rem",minHeight:"130px",backgroundColor:r.backgroundColor,color:r.color,textALign:"left"},children:[e.jsx(l,{variant:"h2",align:"left",color:"primary",children:r.count}),e.jsx(l,{variant:"body2",sx:{lineHeight:1,color:"text.secondary",pr:"30%"},children:r.label})]})}function le(){const{setLoader:r,selectedLocation:u,loader:R,setALLReviews:y,allReviews:h,user:i}=P(),C=G(),[D,I]=n.useState([]),[_,k]=n.useState(0),[A,T]=n.useState(0),[S,L]=n.useState(0),[M,O]=n.useState(0);n.useEffect(()=>{var a,c,t;console.log({selectedLocation:u}),i&&(i!=null&&i.business)&&((a=i==null?void 0:i.business)!=null&&a.businessId)&&u&&(B((c=i==null?void 0:i.business)==null?void 0:c.businessId,u.id),$((t=i==null?void 0:i.business)==null?void 0:t.businessId,u.id))},[i,u]);const $=n.useCallback(async(a,c)=>{r(!0);try{const t=await b(`/review/getall?businessId=${a}&locationId=${c}`);if(t&&t.status===200){const s=t.data.data.map(m=>({...m,id:m._id}));y(s)}}catch(t){console.log(t)}r(!1)},[]),B=async(a="65227a4fd7a294d9ee6f18a6",c="65227ab4d7a294d9ee6f18db")=>{r(!0);try{const t=await b(`/review/getinsightAnalytics?businessId=${a}&locationId=${c}`);t&&t.status===200&&(t.data.insights&&t.data.insights.length&&I(t.data.insights.map(s=>({name:s==null?void 0:s._id,score:(s==null?void 0:s.avgScore)*10,count:s==null?void 0:s.count}))),t.data.categories&&t.data.categories.length&&t.data.categories.map(s=>{switch(s._id){case"negative":T(s.count);break;case"positive":k(s.count);break;case"neutral":L(s.count);break;default:O(s.count);break}}))}catch(t){console.log(t)}r(!1)},z={labels:["Google","Booking.com","GoIbibo","TripAdvisor","MakeMyTrip"],datasets:[{backgroundColor:["#51EAEA","#FCDDB0","#FF9D76","#FB3569","#82CD47"],data:[1,3,1,1,1]}]},E={responsive:!0,plugins:{legend:{position:"bottom",display:!1},title:{display:!0},tooltip:{enabled:!0,position:"nearest"},chartAreaBorder:{borderColor:"red",borderWidth:2,borderDash:[5,5],borderDashOffset:2}}};return e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"h5",fontWeight:500,children:"Dashboard"}),e.jsxs(o,{container:!0,spacing:3,sx:{mt:0},children:[e.jsxs(o,{item:!0,xs:12,md:7.5,children:[e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{item:!0,xs:6,md:3,children:e.jsx(x,{count:S,label:"Neutral Reviews",backgroundColor:"rgb(178 226 254 / 50%)"})}),e.jsx(o,{item:!0,xs:6,md:3,children:e.jsx(x,{count:_,label:"Positive Reviews",backgroundColor:"rgb(178 254 206 / 50%)"})}),e.jsx(o,{item:!0,xs:6,md:3,children:e.jsx(x,{count:A,label:"Negative Reviews",backgroundColor:"rgb(254 178 178 / 46%)"})}),e.jsx(o,{item:!0,xs:6,md:3,children:e.jsx(x,{count:M,label:"Mixed Reviews"})})]}),e.jsxs(d,{sx:{p:2,my:3,bgcolor:"secondary.light",borderRadius:"1rem"},children:[e.jsxs(d,{display:"flex",justifyContent:"space-between",alignContent:"center",children:[e.jsx(l,{variant:"h6",children:"Latest Reviews"}),e.jsx(H,{onClick:()=>C("/reviews"),children:"See All"})]}),!!h.length&&h.slice(0,5).map(a=>e.jsx(q,{...a,date:a.date.split("T")[0],listView:"false"},a.id)),h&&!h.length&&!R&&e.jsx(l,{variant:"body2",children:"No records found"})]})]}),e.jsxs(o,{item:!0,xs:12,md:4.5,sx:{display:"flex",justifyContent:"flex-start",alignItems:"flex-start",flexDirection:"column"},children:[e.jsxs(d,{sx:{bgcolor:"secondary.light",borderRadius:"10px",width:"100%",p:2,mb:3},children:[e.jsx(l,{variant:"h6",fontWeight:500,children:"Review Source"}),e.jsx(d,{px:10,children:e.jsx(J,{chartData:z,options:E})})]}),e.jsxs(d,{sx:{bgcolor:"secondary.light",borderRadius:"10px",width:"100%",p:2,mb:2},children:[e.jsx(l,{variant:"h6",color:"black",gutterBottom:!0,fontWeight:500,children:"Insights"}),e.jsx(d,{children:D.map(a=>e.jsx(V,{title:a.name,children:e.jsx(W,{size:"small",icon:a.score<0?e.jsx(j,{}):e.jsx(w,{}),label:e.jsx("small",{children:U(a.name)}),variant:"outlined",color:a.score>0?"success":"error",sx:{m:.5,px:.5}})},a.name))})]})]})]})]})}export{le as default};
