import{g as D,d as ee,_ as G,e as de,f,h as H,j as a,s as A,k as ue,l as F,b as u,m as te,n as pe,o as _,p as W,q as ae,u as V,t as se,D as oe,L as ne,v as ie,w as re,x as le,c as E,T as S,G as ge,B as U,y as q}from"./index-8f45885e.js";import{R as J}from"./ReviewItem-90fb11b5.js";import{R as xe}from"./ReviewForm-5840bca7.js";import{T as ve}from"./TextField-321b1eb0.js";import{G as Y}from"./Grid-42d30c92.js";import"./useFormControl-c11f480c.js";import"./SwitchBase-2550e058.js";import"./OutlinedInput-3d147791.js";function fe(e){return D("MuiPagination",e)}ee("MuiPagination",["root","ul","outlined","text"]);const be=["boundaryCount","componentName","count","defaultPage","disabled","hideNextButton","hidePrevButton","onChange","page","showFirstButton","showLastButton","siblingCount"];function ye(e={}){const{boundaryCount:t=1,componentName:s="usePagination",count:i=1,defaultPage:l=1,disabled:g=!1,hideNextButton:r=!1,hidePrevButton:n=!1,onChange:b,page:P,showFirstButton:M=!1,showLastButton:z=!1,siblingCount:R=1}=e,x=G(e,be),[p,N]=de({controlled:P,default:l,name:s,state:"page"}),j=(d,I)=>{P||N(I),b&&b(d,I)},y=(d,I)=>{const o=I-d+1;return Array.from({length:o},(c,m)=>d+m)},h=y(1,Math.min(t,i)),v=y(Math.max(i-t+1,t+1),i),B=Math.max(Math.min(p-R,i-t-R*2-1),t+2),$=Math.min(Math.max(p+R,t+R*2+2),v.length>0?v[0]-2:i-1),L=[...M?["first"]:[],...n?[]:["previous"],...h,...B>t+2?["start-ellipsis"]:t+1<i-t?[t+1]:[],...y(B,$),...$<i-t-1?["end-ellipsis"]:i-t>t?[i-t]:[],...v,...r?[]:["next"],...z?["last"]:[]],O=d=>{switch(d){case"first":return 1;case"previous":return p-1;case"next":return p+1;case"last":return i;default:return null}},w=L.map(d=>typeof d=="number"?{onClick:I=>{j(I,d)},type:"page",page:d,selected:d===p,disabled:g,"aria-current":d===p?"true":void 0}:{onClick:I=>{j(I,O(d))},type:d,page:O(d),selected:!1,disabled:g||d.indexOf("ellipsis")===-1&&(d==="next"||d==="last"?p>=i:p<=1)});return f({items:w},x)}function me(e){return D("MuiPaginationItem",e)}const he=ee("MuiPaginationItem",["root","page","sizeSmall","sizeLarge","text","textPrimary","textSecondary","outlined","outlinedPrimary","outlinedSecondary","rounded","ellipsis","firstLast","previousNext","focusVisible","disabled","selected","icon"]),C=he,K=H(a.jsx("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}),"FirstPage"),Q=H(a.jsx("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}),"LastPage"),X=H(a.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore"),Z=H(a.jsx("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext"),Ce=["className","color","component","components","disabled","page","selected","shape","size","slots","type","variant"],ce=(e,t)=>{const{ownerState:s}=e;return[t.root,t[s.variant],t[`size${W(s.size)}`],s.variant==="text"&&t[`text${W(s.color)}`],s.variant==="outlined"&&t[`outlined${W(s.color)}`],s.shape==="rounded"&&t.rounded,s.type==="page"&&t.page,(s.type==="start-ellipsis"||s.type==="end-ellipsis")&&t.ellipsis,(s.type==="previous"||s.type==="next")&&t.previousNext,(s.type==="first"||s.type==="last")&&t.firstLast]},Pe=e=>{const{classes:t,color:s,disabled:i,selected:l,size:g,shape:r,type:n,variant:b}=e,P={root:["root",`size${W(g)}`,b,r,s!=="standard"&&`${b}${W(s)}`,i&&"disabled",l&&"selected",{page:"page",first:"firstLast",last:"firstLast","start-ellipsis":"ellipsis","end-ellipsis":"ellipsis",previous:"previousNext",next:"previousNext"}[n]],icon:["icon"]};return ae(P,me,t)},Re=A("div",{name:"MuiPaginationItem",slot:"Root",overridesResolver:ce})(({theme:e,ownerState:t})=>f({},e.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,padding:"0 6px",margin:"0 3px",color:(e.vars||e).palette.text.primary,height:"auto",[`&.${C.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}},t.size==="small"&&{minWidth:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},t.size==="large"&&{minWidth:40,borderRadius:40/2,padding:"0 10px",fontSize:e.typography.pxToRem(15)})),je=A(ue,{name:"MuiPaginationItem",slot:"Root",overridesResolver:ce})(({theme:e,ownerState:t})=>f({},e.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,height:32,padding:"0 6px",margin:"0 3px",color:(e.vars||e).palette.text.primary,[`&.${C.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${C.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},transition:e.transitions.create(["color","background-color"],{duration:e.transitions.duration.short}),"&:hover":{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${C.selected}`]:{backgroundColor:(e.vars||e).palette.action.selected,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selected} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:F(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(e.vars||e).palette.action.selected}},[`&.${C.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selected} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:F(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)},[`&.${C.disabled}`]:{opacity:1,color:(e.vars||e).palette.action.disabled,backgroundColor:(e.vars||e).palette.action.selected}}},t.size==="small"&&{minWidth:26,height:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},t.size==="large"&&{minWidth:40,height:40,borderRadius:40/2,padding:"0 10px",fontSize:e.typography.pxToRem(15)},t.shape==="rounded"&&{borderRadius:(e.vars||e).shape.borderRadius}),({theme:e,ownerState:t})=>f({},t.variant==="text"&&{[`&.${C.selected}`]:f({},t.color!=="standard"&&{color:(e.vars||e).palette[t.color].contrastText,backgroundColor:(e.vars||e).palette[t.color].main,"&:hover":{backgroundColor:(e.vars||e).palette[t.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[t.color].main}},[`&.${C.focusVisible}`]:{backgroundColor:(e.vars||e).palette[t.color].dark}},{[`&.${C.disabled}`]:{color:(e.vars||e).palette.action.disabled}})},t.variant==="outlined"&&{border:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${C.selected}`]:f({},t.color!=="standard"&&{color:(e.vars||e).palette[t.color].main,border:`1px solid ${e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / 0.5)`:F(e.palette[t.color].main,.5)}`,backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.activatedOpacity})`:F(e.palette[t.color].main,e.palette.action.activatedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / calc(${e.vars.palette.action.activatedOpacity} + ${e.vars.palette.action.focusOpacity}))`:F(e.palette[t.color].main,e.palette.action.activatedOpacity+e.palette.action.focusOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${C.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / calc(${e.vars.palette.action.activatedOpacity} + ${e.vars.palette.action.focusOpacity}))`:F(e.palette[t.color].main,e.palette.action.activatedOpacity+e.palette.action.focusOpacity)}},{[`&.${C.disabled}`]:{borderColor:(e.vars||e).palette.action.disabledBackground,color:(e.vars||e).palette.action.disabled}})})),$e=A("div",{name:"MuiPaginationItem",slot:"Icon",overridesResolver:(e,t)=>t.icon})(({theme:e,ownerState:t})=>f({fontSize:e.typography.pxToRem(20),margin:"0 -8px"},t.size==="small"&&{fontSize:e.typography.pxToRem(18)},t.size==="large"&&{fontSize:e.typography.pxToRem(22)})),we=u.forwardRef(function(t,s){const i=te({props:t,name:"MuiPaginationItem"}),{className:l,color:g="standard",component:r,components:n={},disabled:b=!1,page:P,selected:M=!1,shape:z="circular",size:R="medium",slots:x={},type:p="page",variant:N="text"}=i,j=G(i,Ce),y=f({},i,{color:g,disabled:b,selected:M,shape:z,size:R,type:p,variant:N}),h=pe(),v=Pe(y),$=(h.direction==="rtl"?{previous:x.next||n.next||Z,next:x.previous||n.previous||X,last:x.first||n.first||K,first:x.last||n.last||Q}:{previous:x.previous||n.previous||X,next:x.next||n.next||Z,first:x.first||n.first||K,last:x.last||n.last||Q})[p];return p==="start-ellipsis"||p==="end-ellipsis"?a.jsx(Re,{ref:s,ownerState:y,className:_(v.root,l),children:"â€¦"}):a.jsxs(je,f({ref:s,ownerState:y,component:r,disabled:b,className:_(v.root,l)},j,{children:[p==="page"&&P,$?a.jsx($e,{as:$,ownerState:y,className:v.icon}):null]}))}),Ie=we,Me=["boundaryCount","className","color","count","defaultPage","disabled","getItemAriaLabel","hideNextButton","hidePrevButton","onChange","page","renderItem","shape","showFirstButton","showLastButton","siblingCount","size","variant"],Le=e=>{const{classes:t,variant:s}=e;return ae({root:["root",s],ul:["ul"]},fe,t)},ke=A("nav",{name:"MuiPagination",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,t[s.variant]]}})({}),ze=A("ul",{name:"MuiPagination",slot:"Ul",overridesResolver:(e,t)=>t.ul})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"});function Ne(e,t,s){return e==="page"?`${s?"":"Go to "}page ${t}`:`Go to ${e} page`}const Be=u.forwardRef(function(t,s){const i=te({props:t,name:"MuiPagination"}),{boundaryCount:l=1,className:g,color:r="standard",count:n=1,defaultPage:b=1,disabled:P=!1,getItemAriaLabel:M=Ne,hideNextButton:z=!1,hidePrevButton:R=!1,renderItem:x=w=>a.jsx(Ie,f({},w)),shape:p="circular",showFirstButton:N=!1,showLastButton:j=!1,siblingCount:y=1,size:h="medium",variant:v="text"}=i,B=G(i,Me),{items:$}=ye(f({},i,{componentName:"Pagination"})),L=f({},i,{boundaryCount:l,color:r,count:n,defaultPage:b,disabled:P,getItemAriaLabel:M,hideNextButton:z,hidePrevButton:R,renderItem:x,shape:p,showFirstButton:N,showLastButton:j,siblingCount:y,size:h,variant:v}),O=Le(L);return a.jsx(ke,f({"aria-label":"pagination navigation",className:_(O.root,g),ownerState:L,ref:s},B,{children:a.jsx(ze,{className:O.ul,ownerState:L,children:$.map((w,d)=>a.jsx("li",{children:x(f({},w,{color:r,"aria-label":M(w.type,w.page,w.selected),shape:p,size:h,variant:v}))},d))})}))}),Oe=Be;function Te(e){const{setLoader:t,loader:s}=V(),[i,l]=u.useState(""),g=u.useCallback(async()=>{l("");const r="/gen/reply";t(!0);try{const n=await se(r,{content:e.description});n&&n.status===200&&l(n==null?void 0:n.data.data),t(!1)}catch{t(!1)}},[e.description]);return u.useEffect(()=>{e.description&&g()},[e.description]),a.jsx("div",{children:a.jsxs(oe,{open:e.show,onClose:()=>e.closeHandler,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",maxWidth:"md",fullWidth:!0,children:[!!s&&a.jsx(ne,{color:"primary"}),a.jsx(ie,{id:"alert-dialog-title",children:"Reply Message"}),a.jsx(re,{children:a.jsx(ve,{id:"outlined-multiline-flexible",label:"Draft",fullWidth:!0,multiline:!0,maxRows:10,inputProps:{value:i,name:i},onChange:r=>l(r.target.value),sx:{my:3,fontSize:"0.9rem",color:"text."}})}),a.jsxs(le,{children:[a.jsx(E,{onClick:()=>e.closeHandler(!1),children:"Cancel"}),a.jsx(E,{onClick:()=>e.closeHandler(!1),color:"black",variant:"contained",autoFocus:!0,children:"Post"})]})]})})}function Fe(e){const{setLoader:t,loader:s}=V(),[i,l]=u.useState(""),g=u.useCallback(async()=>{l("");const r="/gen/recommend";t(!0);try{const n=await se(r,{content:e.reviewText});n&&n.status===200&&l(n==null?void 0:n.data.data),t(!1)}catch{t(!1)}},[e.reviewText]);return u.useEffect(()=>{e.reviewText&&g()},[e.reviewText]),a.jsx("div",{children:a.jsxs(oe,{open:e.show,onClose:()=>e.closeHandler,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",maxWidth:"sm",fullWidth:!0,children:[!!s&&a.jsx(ne,{color:"primary"}),a.jsx(ie,{id:"alert-dialog-title",children:"Recommendation"}),a.jsx(re,{children:a.jsx(S,{variant:"body2",children:s?"Please wait...":i})}),a.jsxs(le,{children:[a.jsx(E,{color:"black",variant:"outlined",autoFocus:!0,children:"Share"}),a.jsx(E,{onClick:e.closeHandler,color:"black",variant:"contained",children:"Close"})]})]})})}function Ge(){const{setLoader:e,loader:t,allReviews:s,setALLReviews:i,user:l,selectedLocation:g}=V(),[r,n]=u.useState(null),[b,P]=u.useState(!1),[M,z]=u.useState(10),[R,x]=u.useState(0),[p,N]=u.useState(1),[j,y]=u.useState(null),[h,v]=u.useState(null),[B,$]=u.useState(!1),L=u.useRef("");u.useEffect(()=>{n(s.slice(R,M)),N(s.length>10?Math.round(s.length/10):1)},[s]),u.useEffect(()=>{var o,c;console.log({selectedLocation:g}),l&&(l!=null&&l.business)&&((o=l.business)!=null&&o.businessId)&&g&&O((c=l==null?void 0:l.business)==null?void 0:c.businessId,g.id)},[l,g]);const O=u.useCallback(async(o,c)=>{e(!0);try{const m=await ge(`/review/getall?businessId=${o}&locationId=${c}`);if(m&&m.status===200){const k=m.data.data.map(T=>({...T,id:T._id}));i(k)}}catch(m){console.log(m)}e(!1)},[]),w=o=>{const c=o*10,m=c-10;z(c),x(m),n(s.slice(m,c))},d=o=>{L.current=o.desc,$(!0)},I=o=>{var m;if(console.log({filterData:o}),!o){P(!1),y([]);return}let c=[];r&&(o.source&&Array.isArray(o.source)&&o.source.length&&(c=r.filter(k=>o.source.some(T=>T===k.source))),o.rating<5&&(c=r.filter(k=>{if(k.rating)return k.rating<=o.rating})),(m=o==null?void 0:o.categories)!=null&&m.length&&(c=r.filter(k=>o.categories.some(T=>T===k.category))),P(!0),y(c))};return a.jsxs(a.Fragment,{children:[a.jsx(S,{variant:"h5",fontWeight:500,children:"Reviews"}),a.jsxs(Y,{container:!0,spacing:3,sx:{mt:0},children:[a.jsx(Y,{item:!0,xs:12,md:9,children:a.jsxs(U,{sx:{bgcolor:"secondary.light",borderRadius:"10px",p:3},children:[a.jsx(S,{variant:"body1",gutterBottom:!0,fontWeight:500,children:"List of all reviews"}),r&&!!r.length&&!b&&r.map(o=>a.jsx(J,{date:q(o.date).format("DD/MM/YYYY"),onReply:c=>v(c),onRecommend:c=>d(c),listView:!1,...o},o.id)),j&&!!j.length&&!!b&&j.map(o=>a.jsx(J,{date:q(o.date).format("DD/MM/YYYY"),onReply:c=>v(c),onRecommend:c=>d(c),listView:!1,...o},o.id)),r&&!r.length&&!t&&a.jsx(S,{variant:"h6",children:"No records found"}),r&&!!r.length&&a.jsx(U,{sx:{my:2,px:2,ml:"auto",width:"100%","& .MuiPagination-ul":{justifyContent:"flex-end"}},children:a.jsx(Oe,{count:p,variant:"outlined",shape:"rounded",onChange:(o,c)=>w(c)})})]})}),a.jsx(Y,{item:!0,xs:12,md:3,sx:{display:{xs:"none",md:"flex"},justifyContent:"center",alignItems:"flex-start"},children:a.jsxs(U,{sx:{bgcolor:"secondary.light",borderRadius:"10px",p:3,width:"100%"},children:[a.jsx(S,{variant:"body1",gutterBottom:!0,fontWeight:500,children:"Filters"}),a.jsx(xe,{sourcesFilter:I,showCategory:!0})]})})]}),h&&a.jsx(Te,{title:h.title,description:h.desc,show:!!h,closeHandler:()=>v(null),rating:h.rating}),a.jsx(Fe,{reviewText:L.current,show:B,closeHandler:()=>$(!1)})]})}export{Ge as default};
